<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«é›†</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: var(--bg-color); color: var(--text-color); transition: all 0.3s ease; }
    .container { padding-top: 2rem; }
    .tab-content > .tab-pane { padding-top: 1rem; }
    .output { margin-top: 1rem; white-space: pre-wrap; }
    :root {
      --bg-color: #f9f9f9;
      --text-color: #000;
    }
    body.dark {
      --bg-color: #121212;
      --text-color: #f0f0f0;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1>ğŸ§° ç”Ÿæ´»ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«é›†</h1>
      <button class="btn btn-secondary" onclick="toggleDarkMode()">ğŸŒ“ ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿</button>
    </div>

    <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <ul class="nav nav-tabs" id="toolTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="char-tab" data-bs-toggle="tab" data-bs-target="#char" type="button" role="tab">æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="qr-tab" data-bs-toggle="tab" data-bs-target="#qr" type="button" role="tab">QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="img-tab" data-bs-toggle="tab" data-bs-target="#img" type="button" role="tab">ç”»åƒåœ§ç¸®</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pdf-tab" data-bs-toggle="tab" data-bs-target="#pdf" type="button" role="tab">PDFçµåˆ</button>
      </li>
    </ul>

    <!-- ã‚¿ãƒ–å†…å®¹ -->
    <div class="tab-content">
      <!-- æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ -->
      <div class="tab-pane fade show active" id="char" role="tabpanel">
        <h2 class="mt-3">ğŸ“ æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ</h2>
        <textarea id="charText" rows="5" placeholder="ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
        <button class="btn btn-primary mt-2" onclick="countChars()">ã‚«ã‚¦ãƒ³ãƒˆ</button>
        <div class="output" id="charCount"></div>
      </div>

      <!-- QRã‚³ãƒ¼ãƒ‰ -->
      <div class="tab-pane fade" id="qr" role="tabpanel">
        <h2 class="mt-3">ğŸ”³ QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</h2>
        <input id="qrText" type="text" class="form-control" placeholder="ãƒ†ã‚­ã‚¹ãƒˆã¾ãŸã¯URLã‚’å…¥åŠ›">
        <button class="btn btn-success mt-2" onclick="generateQR()">ç”Ÿæˆ</button>
        <div id="qrcode" class="text-center mt-3"></div>
      </div>

      <!-- ç”»åƒåœ§ç¸® -->
      <div class="tab-pane fade" id="img" role="tabpanel">
        <h2 class="mt-3">ğŸ–¼ï¸ ç”»åƒåœ§ç¸®</h2>
        <input type="file" id="imgInput" accept="image/*">
        <button class="btn btn-warning mt-2" onclick="compressImage()">åœ§ç¸®</button>
        <div id="compressedResult" class="mt-3"></div>
      </div>

      <!-- PDFçµåˆ -->
      <div class="tab-pane fade" id="pdf" role="tabpanel">
        <h2 class="mt-3">ğŸ“ PDFçµåˆ</h2>
        <input type="file" id="pdfs" multiple accept="application/pdf">
        <button class="btn btn-danger mt-2" onclick="mergePDFs()">çµåˆ</button>
        <div id="pdfResult" class="mt-3"></div>
      </div>
    </div>

    <!-- BuyMeACoffee -->
    <div class="text-center mt-5">
      <a href="https://www.buymeacoffee.com/yourname" target="_blank">
        <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" style="height: 45px; width: 162px;">
      </a>
    </div>
  </div>

  <!-- ãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    function toggleDarkMode() {
      document.body.classList.toggle('dark');
    }

    function countChars() {
      const text = document.getElementById('charText').value;
      document.getElementById('charCount').innerText = `æ–‡å­—æ•°: ${text.length}`;
    }

    function generateQR() {
      document.getElementById('qrcode').innerHTML = '';
      new QRCode(document.getElementById('qrcode'), document.getElementById('qrText').value);
    }

    async function compressImage() {
      const file = document.getElementById('imgInput').files[0];
      if (!file) return;
      const img = new Image();
      img.src = URL.createObjectURL(file);
      img.onload = () => {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = img.width / 2;
        canvas.height = img.height / 2;
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        canvas.toBlob(blob => {
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = 'compressed.jpg';
          link.innerText = 'åœ§ç¸®ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰';
          document.getElementById('compressedResult').innerHTML = '';
          document.getElementById('compressedResult').appendChild(link);
        }, 'image/jpeg', 0.7);
      };
    }

    async function mergePDFs() {
      const files = document.getElementById('pdfs').files;
      if (files.length < 2) return alert('æœ€ä½2ã¤ã®PDFãŒå¿…è¦ã§ã™');
      const mergedPdf = await PDFLib.PDFDocument.create();
      for (const file of files) {
        const bytes = await file.arrayBuffer();
        const pdf = await PDFLib.PDFDocument.load(bytes);
        const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
        copiedPages.forEach(p => mergedPdf.addPage(p));
      }
      const mergedBytes = await mergedPdf.save();
      const blob = new Blob([mergedBytes], { type: 'application/pdf' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'merged.pdf';
      link.innerText = 'çµåˆPDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰';
      document.getElementById('pdfResult').innerHTML = '';
      document.getElementById('pdfResult').appendChild(link);
    }
  </script>
</body>
</html>
